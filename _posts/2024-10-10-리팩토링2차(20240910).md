---
title: 리팩토링 2차 (20240910)
date: 2024-10-10
tags:
  - 케이뱅크
  - 주식서비스
  - 개발
  - 아키텍처
category:
  - 실무경험
  - 비상장주식알림서비스
---

투자홈 개발 과정에서 도입한 Mediation 패턴을 기반으로, 각 주식 서비스 간 강결합을 해소하기 위한 2차 리팩토링 계획 정리.

→ Mediation 패턴 도입 상세 내용: [mediation 패턴 도입기]({% post_url 2024-11-26-mediation 패턴 도입기 %})

---

### 배경

투자홈 개발 당시 주식 단위업무에 Mediation 패턴을 도입했다. 당시 공모주 메이트·비상장주식 알림 서비스와의 강결합 문제가 있었으나, 주식 단위업무가 추가되는 시점에 Mediation 패턴을 도입하고 서비스 간 결합을 끊기로 합의한 바 있었다. 2차 리팩토링은 그 약속을 이행하는 작업이다.

---

### AS-IS

각 주식 서비스가 관심 종목·푸시 동의 데이터를 자체적으로 보유하는 구조.

| 서비스 | 보유 데이터 |
|---|---|
| 공모주 서비스 | 푸시 동의 |
| 비상장주식 서비스 | 관심 비상장주식, 푸시 동의 |
| 국내주식 서비스 | (예정) 관심 상장주식 |
| 해외주식 서비스 | (예정) 관심 해외주식 |

서비스마다 유사한 역할의 테이블(관심, 푸시 동의)이 분산·중복되어 있어, 횡단 관심사(cross-cutting concern)가 각 서비스에 혼재된 상태.

---

### TO-BE

관심 종목·푸시 동의를 독립 서비스로 분리하여 각 주식 서비스는 핵심 도메인 로직에만 집중.

| 서비스 | 역할 |
|---|---|
| 공모주 서비스 | 공모주 도메인 로직 |
| 비상장주식 서비스 | 비상장주식 도메인 로직 |
| 국내주식 서비스 | 국내주식 도메인 로직 |
| 해외주식 서비스 | 해외주식 도메인 로직 |
| **관심 서비스** | 전 자산군 관심 종목 통합 관리 |
| **푸시 동의 서비스** | 전 서비스 푸시 동의 통합 관리 |

각 서비스에 산재해 있던 관심 테이블·푸시 동의 테이블을 전용 서비스로 이관하고, 나머지 서비스와의 결합을 Mediation 패턴을 통해 느슨하게 연결한다.
