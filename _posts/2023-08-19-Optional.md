---
title: "Optional"
date: 2023-08-19
tags: [미지정]
---

## Null참조 문제점

일단 에러가 겁나 많이 남
코드가 어지러움
아무 의미가 없는걸 null로 표현
자바는 개발자로부터 모든 포인터를 숨겼는데 null포인터만 예외임
무형식인 null은 모든 참조형식에 들어갈 수 있는데 계속 null이 전이되다 보면 이게 어디서 어떤 의미로 시작되었는지 알지 못함


## Optional


![](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2fa705c4-5794-4c39-a24f-9bea986e7325/Untitled.png)


```java
//null이 아닌 값으로 optional 만들기
Optional<Car> optCar = Optional.of(car);
//null값으로 optional 만들기
Optional<Car> optCar = Optional.ofNullable(car);
```


```java
Optional<Insurance> optInsurance = Optional.ofNullable(insurance);
Optional<String> name = optInsurance.map(Insurance::getName);
//optInsuracne가 empty라도 null exception은 일어나지 않음.
```


```java
public Optional<String> getCarInsuranceName(Optional<Person> person){
	return person.map(Person::getCar)
								.map(Car::getInsurance)
								.map(Insurance::getName);
}//이렇게 하면 안됨. optional을 두 번 싸는것과 같음

public String getCarInsuranceName(Optional<Person> person){
	return person.flatMap(Person::getCar)
								.flatMap(Car::getInsurance)
								.map(Insurance::getName)
								.orElse("Unknown"); //마지막 결과값 비어있으면 기본값
}
```

참고 : input값을 optional 지정하는 경우는 큰 효과가 없다. Optional 타입인데 null로 넘겨주면 ㅈㅈ

```java
public Optional<Integer> getSomething(Optional<Integer> input){
	if(input != null) //이런 식으로 input은 솔직히 보장 못함
//대신 우리가 외부에 Optional을 제공해 주면서 nullsafe를 보장 하다는 사상
	return null //진짜 이렇게 구현하면 키보드로 맞아도 무죄
}
```


### 잠재적 null 대상 optional 변환


```java
public static Optional<Integer> stringToInt(String s) {
	try {
		return Optional.of(Integer.parseInt(s));
	} catch (NumberFormatException e) {
		return Optional.empty(); //변환 실패 시 빈 객체 반환
	}
}
	
```

TMI) 기본형 Optional(OptionalInt,,)는 map, flatMap, filter 미지원
