---
title: "개인적인 생각 with Facade(20230910)"
date: 2023-09-10
tags: [미지정]
---
협업이든지 개발이든지 다 좋고 아무튼 개인적으로 느낀 점
stateless 할 수록 재사용성이 좋다(정확한 표현은 아님, 정확하게는 scalable과 유연성 관련되면 stateless한것이 좋다)
같은 레벨에서 호출하는것은 쉽지않다.
→ 그러므로 우리는 “짬통” 역할을 하는 무언가가 필요하다


### 가장 이상적이다고 생각하는 구조


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/7481f3bc-a6e0-4533-ad39-6409a0faf18b/Untitled.png)

이런식으로 호출이 될 텐데 dependency 관계를 그려보면 Repository(DAO)가 가장 상위의 개념일 것이고, 그 다음이 서비스, 그 다음이 컨트롤러 이런식으로 될것임
다음과 같은 가정을 하고 그려본다 - dependency가 생기면 depth를 올린다
state가 있다면 가급적 최상위로 옮긴다
controller는 주고받는 로직만 넣자
그럼 대충 이런 느낌으로 트리가 만들어짐

![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/bf5477e5-8869-4d8c-9b1f-b5e6b511196c/Untitled.png)

Repository,Service,Controller의 숫자는 그때그때 다르긴할건데 아무튼 
Service는 각 Repository의 조합, Controller는 각 Service의 조합으로 만들어질 것

가장 이상적인상황(본인이 느끼기에)이라고 생각하지만 현실적으로는 다음과 같은 제약이 있음
연결을 유지하거나 특정한 상태가 필요한 서비스
서비스의 상호호출
을 반영하여 다시 그려봄. 
아래는 1번을 반영한 그림

![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/9be3d0b5-4fd7-4675-a304-123a46380816/Untitled.png)

stateful하거나 외부 네트워크를 타는(따지고보면 이것도 Stateful할 수 있다) 경우는 대체로 다른 서비스들이 방금 말한 서비스들에 의존할 것이므로 1depth 차이나지만 repository에 의존할 수 있으므로
2번을 반영한 그림

![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/ef6aa0c7-03fa-4336-af84-1f5917ff9988/Untitled.png)

서비스 A와 D는 B와 C를 호출하고 있기 때문에 1 depth 차이남. 위에서 서비스는 총 3 depth 차이가 나므로 생각보다 간단하게 표현할 수 있지만 계속 상호 참조한다면 depth가 무한으로 늘어나 영향도 파악이 안될듯

결국에 위 상황에 대한 교통정리를 담당할 무언가가 필요함. 그러니깐 짬통이 될 수 있음
위 상황을 해결할 솔루션은 크게 세 가지라고 생각
컨트롤러에서 서비스들의 조합을 한다 → 싫다

![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/88a503b7-270b-4ad7-8b28-402f98a5f484/Untitled.png)

나름 괜찮아보이는데 1. 컨트롤러에 너무 많은 영역의 일을 시키고 2. 그래서 컨트롤러가 짬통화 되어버림
서비스의 공통 Business를 잘 정의해서 추가적인 depth가 생기는 것을 최대한 자제한다

![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/9ac6d981-dd8b-4bed-ae0e-09d8a7cd62eb/Untitled.png)

그러니깐 여기서 자주호출되는 서비스를 잘 정리해놨다가 코드리뷰 같은곳에서 걸러야함(타협)
이 방법이 대부분 쓰는 방식일텐데 해당 도메인 업무 담당자가 업무에 대한 이해를 잘 해야함
Facade

![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/8cb15128-a867-4eb3-8fa1-7e94d73c0fc9/Untitled.png)

이런식으로 서비스 중간에 은닉계층을 하나 만들어서 상하위간 영향이 없도록 함
문제점 
코드중복 발생
개발 귀찮음

절충점을 찾아야지..
