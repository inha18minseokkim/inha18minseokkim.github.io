---
title: "Branch 전략 논의"
date: 2023-10-27
tags: [미지정]
category: 기타
---

### 전제 및 한계점

기존에 행내에 유지되고 있던 형상관리시스템, 을 리뉴얼한 ITSquare의 변경관리계획 및 절차를 깨뜨리기 힘듬(기존 품질강화팀의 프로세스를 바꾸기는 현실적으로 한계가 있음)


### 기존 형상 프로세스


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/7e155f20-461b-467f-8252-d9c657cdda2d/Untitled.png)

요구사항 한 건에 대해 N건의 변경계획건 할당 가능, 변경계획건 한 건에 대해 개발건 N건 변경 가능(9월부터 시작)
변경계획 변경 시 롤백하지 않고 요구사항 변경을 통해 새로 할당 및 정정(기존에는 롤백함)


### Branch 전략 반영


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/db4b7159-c1ce-44f0-9c72-a38ad39d687d/Untitled.png)

main브랜치는 건들지 않는다(CHA 운영반영 후 이상없으면 main브랜치에 머지 치는 용도)
변경요청건이 들어오는 경우 main에서 CHA 브랜치를 fork 한다
각 하위 개발건에 대해 PKG브랜치를 할당하여 주기적으로 CHA브랜치에 커밋
PKG는 개발서버에서 단위테스트, CHA에 스테이징 반영 후 주기적으로 통합테스트
실제 파이프라인을 통해 운영환경에 배포되는 브랜치는 CHA


### 문제점

CHA 브랜치가 동시에 여러건이고 배포시점이 다를 경우 각 버전의 소스코드가 맞지 않을 수 있음(극히 적은 경우)
  - 이런 경우 먼저 운영 반영하는 CHA 브랜치가 아직 개발중인 CHA 브랜치에 머지를 시도해야함
  - 이런 문제가 있기 때문에 프로젝트를 쪼개기를 시도해야 할 수 있음

그리고 2024년 상반기, 위 사단이 나버렸는데,,,,
  - 프로젝트 수가 많아짐에 따라 문서가 많아져(변경계획관리,개발) 문서작업이 많아짐.
  - pod : project : 변경계획이 1:1:1 인 이상 코드간 영향도 격리와 로직 독립성을 위해 프로젝트를 무조건 분리하는것은 케이뱅크 현재 내부에서는 쉽지 않다.  

### Main 브랜치를 운영에 반영하지 않는 이유

기존 형상 프로세스를 사용해야  하기 때문
어차피 main 반영해서 문제생기면 마지막으로 반영한 CHA branch가 뭔지 봐야됨
다만 CHA 브랜치가 여러 개인 경우 main과 CHA에서 배포되는 운영환경이 100%같다고 생각할 수 없기 때문에 CHA가 동시에 여러 건 존재하는경우가 가급적이면 없어야 함
[결재 반려 시 gitlab branch delete 이슈]({% post_url 2023-12-20-결재 반려 시 gitlab branch delete 이슈 %})
