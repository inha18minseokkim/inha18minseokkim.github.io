---
title: "v3.6 cron stop.strategy (20240928)"
date: 2024-09-28
tags: [미지정]
category: 기타
---
한달도 안된 3.6버전에서 새로 들어온 크론잡 중지조건
회사에서 쓸려면 3.5.1 → 3.6으로 올리자고 요청해야 함.


```javascript
apiVersion: argoproj.io/v1alpha1
kind: CronWorkflow
metadata:
  name: one-minute-limit-cron
spec:
  schedule: "*/1 * * * *"      # 1분마다 작동
  concurrencyPolicy: "Forbid"  # 동시실행 안됨
  startingDeadlineSeconds: 60 # 딜레이 1분이상 안됨
  successfulJobsHistoryLimit: 5  # 성공한 잡 히스토리는 다섯 개 유지
  failedJobsHistoryLimit: 5    # 실패한 잡 히스토리는 5개 남겨
  stopStrategy:
    condition: "succeeded >= 5" #다섯 번 실행하면 멈춰 와 근데 이거 3.6 이상이네 이거 왜있는거?
                                #20240928 기준으로 3.6버전은 아직 rc1으로 정식버전아니다
  workflowSpec:
    entrypoint: main
    activeDeadlineSeconds: 60 # 워크플로우 잡이 1분 이상 실행되면 안됨
    templates:
      - name: main
        container:
          image: busybox
          command: [echo]
          args: ["Run every 1 minutes : $(date)"]
```


```javascript
argo cron create -n argo one-minute-limit-cron.yaml
```


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/c38aebd7-2834-4fac-b2fc-a2f0c17ce81d/ec545c09-3551-477f-a287-7fe22b79cad1/image.png)

다섯 번 실행 후 job stop

```javascript
argo cron update -n argo one-minute-limit-cron.yaml
```

update 하면 다시 실행 시작됨

다만 없는 상태에서 update는 안됨
