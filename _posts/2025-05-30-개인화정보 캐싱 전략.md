---
title: "개인화정보 캐싱 전략"
date: 2025-05-30
tags: [미지정]
category:
  - 기타
---

# 상황

메인 화면에 들어올 때 가장 첫 번째로 노출되는 화면이 고객이 최근 본 종목 + 최근 본 시점의 가격과 현재 가격을 비교해서 몇% 변동했는지를 카드로 보여줘야 함. 최대 1주일, 가장 최근 조회 목록으로부터 30개
DAU 60만 정도로 잡으면 그냥 진짜로 하루 호출이 200만건 정도 일어난다고 봐야 함.
  - 그러므로 캐싱없이 사용하려면 원쿼리 말고는 해결 안될듯(이것도 힘들어)
  - 가급적이면 각 서브 도메인의 인프라 조합 없이 서비스 레이어에서의 api 조합으로 끝내고 싶다(간결한 코드와 유지보수를 위해)
layer별로 나눠보면
- 고객의 최근 조회 종목 30개 
  - 각 종목의 조회 시점 가격 + 현재 최신 시점 가격의 차이
    - 해당 종목의 조회 시점 가격
    - 해당 종목의 최신 가격
해당 종목의 조회 시점 가격과 해당 종목의 최신 가격은 각 업무단에서 캐싱되어야 한다.
  - 그렇기 때문에 캐싱 공간 관리를 위해 최대 1주일간 접근 기록만 노출하기로 했고
  - 최신가격의 경우 다른 api에서도 사용하기 때문에 이미 충분히 캐싱되어있음

그러므로 7일 간의 시장 정보들(2700+6000+1500) 을 추가 캐싱 해야함
어떻게 할까
1. (티커, 기준날짜) 로 캐싱한다
2. (기준날짜) 의 티커 리스트로 캐시해서 리스트에서 뽑아쓴다

### 우선 협의하고 넘어가면 좋은 점

가급적 개인화된 히스토리 정보는 채널에서 캐싱해주면 좋겠다는 생각이 듦.
1. 개별 히스토리 검색할 때 마다 그 당시 가격정보와 종목정보를 캐싱해
2. 최신정보와 함께 가격 차이를 계산해서 보여줘야 함
프론트 개발자가 해주면 좋겠지만..바빠가지고 못하면 mediation 파드에서 조합해줘야함.
