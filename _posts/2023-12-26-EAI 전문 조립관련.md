---
title: "EAI 전문 조립관련"
date: 2023-12-26
tags: [미지정]
category:
  - 기술
---

### 안되는것

메타 기준을 바꾸는 것
  - 어딘가에서는 행내 메타 표준으로 Entity를 매핑해주는 로직 필요
  - → 그러므로 오픈API를 통해 데이터를 가져오는 컬럼값을 우리 행에서 못쓸 확률 99%
ddl 자동화 안됨
  - 테이블을 직접 ddl로 선언해서 메타신청 해야함
EAI를 거치지 않고 외부로 바로 통신하는것
  - 응 안됨 절대안됨
  - 망분리 규제 때문에 EAI 대외 담당자분께서 보안성심의 통과, 방화벽 예외 신청을 해야한다
  - 이건 EKS에 물려있는 VPC 내부에서도 마찬가지로 Egress → Remote가 아니라 Egress → Kbank IOC → EAI → Remote → EAI → Ingress로 와야함


### 되는것(헤쳐나가야함)

json → json 으로 EAI의 openApi 솔루션을 “경유” 하는 것(릴레이)
  - 현재는 행내 통신 표준 규격이 fixedLength 이므로 전문 스펙을 EAI 담당자에게 줌
  - crd에서 EAI로 줄 때 fixed로 줌 → EAI에서 FIXED로 전문을 받은 openApi 솔루션은 그걸 json으로 매핑 → 외부에 json으로 던짐
  - → 받을때 json으로 받음 → openApi에서 EAI로 던질 때 fixed로 매핑 → crd가 fixed로 받아서 dto 매핑
  - 이걸 사실은 json to json 솔루션이 있으므로 tobe 환경에서 json으로 받으려 하면 할 수 있다.


### 결론(개발완료)

ASIS
  - EAI Call을 할 때 HTTP Body Part에 fixedLength로 받아옴. openApi가 대외에서 온 json 파일을fixedLength로 조립해서 줌
TOBE
  - EAI Call을 할 때 HTTP Body Part에 json을 통 String으로 받아서 어플리케이션에서 jackson을 활용하여 매핑. openApi는 대외에서 온 json 파일을 Http Body part에 통으로 담아서 그냥 업무어플리케이션으로 던짐
방화벽 신청같은것은 늘 해야함

개발완료 인줄 알았으나 추가적인 문제 생김. EAI에서 1MB 이상 바디전문을 수신하는 경우 OOM 발생
→ 즉 페이징을 해서 1. 바디부 용량을 1메가 미만으로 안정적으로 뽑을 수 있고 2. 호출 빈도가 그렇게 잦지 않으면(10tps 이상 쏘면 중간에 유실남) 해당 방법을 사용해도 됩니다.
