---
title: immutable class
date: 2023-09-15
tags:
  - Java
category: 기술
---
안전하고 오류생길여지 x
Thread Safe, 동기화 안해도됨
  - 읽어서 쓰기만 하니
함수형 프로그래밍 가능
  - 멱등적으로, 외부 요소를 내부에서 바꾸지 않음(오로지 input → output, 심지어 input을 복사하기도 함)
실패 원자성 제공
  - 멱등적이므로 똑같은 짓을 몇 번 해도 같은 결과가 나옴
모든 외부에 공개하는 필드는 final이어야 함
  - 그렇지 않고 그냥 private만 사용한다면 후에 extend 하여 바뀔 수 있음. 아니면 그냥 클래스를 final로 선언하면됨.
  - 생성 시 비용이 많이 드는 값은 lazy loading 하고 캐싱하는 식으로 만들어도됨(변수는 private으로 두고 get 호출 시 로딩하거나 이미 값이 있으면 해당 값을 넘겨주는 식으로)


### 장점

1. setter 제공하지 않음
2. 확장 못하게(private으로 멤버가 선언되어도 상속하면서 public으로 바꿀 수 있음)final로 선언
3. 모든 필드를 final로 선언
4. 모든 필드를 private로 선언
5. private final 뿐만 아니라 내부의 가변 컴포넌트에 접근(레퍼런스를 통한 변경)하지 못하게 함.

### 단점

1. 별도의 객체 일일이 만들어야함. 만드는 과정에서 자원이 많이 필요하거나 제한적인 경우 사용할 수 없다
  - 그래서 다단계 연산을 제공하거나 가변 동반 클래스 제공함 ex)String - StringBuilder


### 정적 팩토리 빌드

생성자 노출을 제한하고 특정 빌드 함수를 사용하여 객체를 리턴하도록 하는 빌더 패턴
  - → 만약 특정 클래스가 immutable 하다면  빌드에서 이미 로딩된 객체를 리턴하는 캐싱 방법으로  사용 가능
