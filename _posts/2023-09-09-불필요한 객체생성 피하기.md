---
title: 불필요한 객체생성 피하기
date: 2023-09-09
tags:
  - Java
  - 개발
category: 기술
---

```java
String hello = "hello";
String hello2 = new String("hello");
System.out.println(hello == hello2); //이렇게 비교하면 false, 인스턴스가 같다면 true가 나올 듯
System.out.println(hello.equals(hello2));//이렇게 비교해야 true
```

2번은 좋지않은 사례.
JVM 내부적으로는 캐싱을 사용하여 문자열 풀에서 동일 문자열 재사용 하는 식으로 함
new 쓰면 불필요하게 강제 생성

정규표현식 - cpu 리소스를 사용해서 한 번 만들 때 좀 비쌈
자주 쓰는 패턴은 객체를 항상 생성하지 말고 필드로 선언해서 사용. 계속 만들면 만들고 GC 만들고 GC 반복..

메모리 불필요한 낭비 & RegEx의 경우 CPU도 그렇다

```java
public class RegularExpression {
	private static final Pattern SPLIT_PATTERN = Pattern.compile(",");
	public static void main(String[] args) {
		long start = System.nanoTime();
		for(int j = 0; j < 10000; j++) {
			String name = "keesun,whiteship";
			name.split(",");
		//SPLIT_PATTERN.split(name);
		}
		System.out.println(System.nanoTime() - start);
	}
}
```

대상 문자가 하나인 경우 ex), ; . 그냥 split 써도 되지만 길이가 2이상인 경우 Pattern으로 미리 컴파일해놓고 사용하면 성능 좋음

# Auto boxing & unBoxing

primitive type ↔ Reference type 간 불필요한 캐스팅을 피하자
