---
title: "Raptor RAG 활용 공시 문서 압축 요약"
date: 2026-01-26
tags: [미지정]
category: 기타
---

![](attachment:7bbae049-4b0a-470c-bf1e-98060ab92796:image.png)

상당히 큰 문서, 어떻게 하면 간단하게 장문의 문서의 요약을 쉽게 할 수 있을까 라는 생각
Raptor RAG라는 방법론이 있어서 구현해본다


![](attachment:fef5ab98-84ef-4ff3-90e8-5d2cff136d5e:image.png)



![](attachment:74384357-56b1-4476-b231-ef504cfc223a:image.png)

- **Root 노드** (상단 분홍색): 전체 문서의 최상위 요약.
- **중간 Layer** (연한 노드들): 클러스터 요약들.
- **Leaf Layer** (하단 1~9): 원본 텍스트 청크들.
  - 원본 문서를 100토큰 단위로 쪼개서 


주요 흐름: 임베딩 → KMeans 클러스터링 → GPT 요약 → 계층적 구조 생성.


## 입력 매개변수


```shell
text- embeddings: [[float]] - 문서별 SBERT 임베딩 벡터들
- n_clusters: int (선택) - 클러스터 수 (자동 계산 가능)
- max_cluster_size: int=10 - (핵심 제어값): 클러스터당 최대 문서 수
```


## 출력

`[0, 1, 0, 2, ...]` 형태의 클러스터 레이블 리스트.


## `summarize_cluster` 함수 분석


## 클러스터 요약 전략

`text단일 문서 → 그대로 반환 (불필요한 GPT 호출 방지)
다중 문서 → 결합 후 GPT-4o-mini로 추상적 요약`

## GPT 프롬프트 설계 (금감원 특화)


```shell
messages = [
    {
        "role": "system",
        "content": "당신은 금융 공시 문서를 분석하는 전문가입니다. 여러 관련 문서들을 읽고 핵심 내용을 포괄적으로 요약해주세요."
    },
    {
        "role": "user",
        "content": f"""다음은 서로 관련된 문서 내용들입니다:

{combined_content}

위 문서들의 공통 주제와 핵심 내용을 포괄적으로 요약해주세요.
요약은 다음을 포함해야 합니다:
1. 주요 내용과 핵심 정보
2. 구체적인 수치나 날짜가 있다면 포함
3. 중요한 세부사항

요약문은 명확하고 정보가 풍부하게 작성해주세요."""
        }
    ]

```






### 요약 예시


![](attachment:ef5f6d71-ecd5-4e9a-9840-4e2b4765449f:image.png)



최종 요약본

```shell
### 1. 개요
SK디스커버리와 그 자회사 SK플라즈마 및 SK바이오사이언스에 대한 공시 문서들은 이들 기업의 재무 상태, 사업 전망, 투자 계획 및 관련 위험 요소를 포괄적으로 다루고 있습니다. 특히 제약 및 바이오 산업의 성장 가능성과 LPG 사업의 시장 환경을 분석하고 있습니다.

### 2. 주요 내용
- **제약 및 바이오 산업**:
  - SK케미칼의 제약사업은 고령화 사회와 만성질환 증가로 안정적인 성장세를 보일 것으로 예상되나, 정부의 약가 인하 압박이 지속될 위험이 있음.
  - SK바이오사이언스는 COVID-19 백신 개발을 통해 글로벌 시장에서 입지를 강화하고 있으며, 다양한 백신 제품을 보유하고 있음.

- **LPG 사업**:
  - SK가스는 LPG 수입 및 판매를 통해 수익을 창출하고 있으며, 국제 LPG 가격 변동에 민감함.
  - 2025년 LPG 차량 등록 대수는 소폭 감소할 것으로 예상됨.

- **투자 계획**:
  - SK디스커버리는 SK멀티유틸리티의 열병합발전소 건설 및 SK바이오사이언스의 R&D 센터 건설 등 다양한 CAPEX 투자를 진행하고 있음.
  - SK플라즈마는 유상증자를 통해 자금을 조달하고 있으며, 희귀난치성 질환 치료제를 개발 중임.

### 3. 재무 정보
- **2025년 3분기 기준**:
  - SK케미칼의 연결 부채비율: 82.8%, 유동비율: 215.2%
  - SK플라즈마의 매출: 1,593억원, 영업이익: 202억원
  - SK바이오사이언스의 매출: 4,672억원, CDMO 매출 비중 74.0%
  - SK디스커버리의 부채비율: 134.4%

### 4. 리스크 요소
- **경쟁 및 규제**:
  - 제약산업의 높은 경쟁 강도와 정부의 규제 강화가 수익성에 부정적 영향을 미칠 수 있음.
  - LPG 사업은 국제 유가 및 환율 변동, 정부의 규제, 경쟁 심화 등으로 인해 수익성이 하락할 위험이 존재.

- **법적 리스크**:
  - SK디스커버리는 백신 입찰 담합과 관련하여 법적 소송을 진행 중이며, 이로 인한 재무적 부담이 우려됨.

### 5. 결론
SK디스커버리와 그 자회사들은 각각의 사업 분야에서 성장 가능성을 보이고 있으나, 정부 규제와 경쟁 심화, 법적 리스크 등 다양한 위험 요소를 안고 있습니다. 투자자들은 이러한 요소들을 충분히 고려하여 신중한 투자 결정을 내릴 필요가 있습니다.
```

