---
title: "Stateless - MSA"
date: 2023-08-01
tags: [MSA, 아키텍처, 백엔드, 인턴]
---

## 멱등성

같은 요청을 여러 번 해도 결과가 동일한 성질. Stateless 설계의 기반이 되는 개념이다.

---

## Stateless

**리퀘스트 사이에서 어떠한 정보도 유지하지 않고, 사용하지 않는 시스템**을 의미한다.

각각의 Request는 독립적이며 시스템 내 context나 정보가 없다.

HTTP Request는 기본적으로 Stateless하지만, 세션/쿠키 등을 통해 상태를 유지하도록 만들 수도 있다.

### 분산 환경에서 괜찮은 메커니즘

- 상태 정보를 공유하지 않으므로 복제 및 분산이 쉽다
- 데이터 일관성 문제가 없다

### Advantages of Stateless Container on MSA

1. 쉬운 수평적 확장 — 어느 인스턴스에 요청이 가도 결과가 같음
2. Fault Tolerance — 인스턴스 하나가 죽어도 다른 인스턴스가 처리
3. 빠르고 간단한 배포 — 상태 마이그레이션 없이 배포 가능
4. 보안성 강화 — 요청 간 정보가 남지 않음
5. 유연성 및 모듈 교체 용이성

### Stateful한 인스턴스 예시

1. DB 데이터 저장
2. 사용자 세션 정보를 보유한 서버

불가피하게 상태를 저장해야 하면 Stateful로 설계하고, 나머지는 Stateless로 유지한다.

---

## MSA 분리 전략

**"Stateful 영역과 Stateless 영역을 나누자"**

MSA 분리의 첫 단계는 이 구분부터다.

서비스 예시 (온라인 서점):

- **Reviews 서비스** — 상품 리뷰 조회/등록
- **User Account 서비스** — 회원 정보 (Stateful)
- **Inventory 서비스** — 재고 관리
- **Transactions 서비스** — 결제/주문 처리
- **Cart 서비스** — 장바구니
- **Marketplace 서비스** — 상품 목록

마이크로서비스의 크기는 **팀 당 서비스 개수 기준**으로 정하는 게 현실적이다. 네트워크 비용(IPC)을 고려하면 너무 잘게 쪼개는 것도 문제다.

결론: **Case by Case**. 도메인 요소를 분리하고, 팀이 독립적으로 배포할 수 있는 단위가 적절한 마이크로서비스 크기다.
