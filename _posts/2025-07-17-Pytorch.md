---
title: "Pytorch"
date: 2025-07-17
tags: [AI/ML]
category: 기타
---
torch는 dtype float32 기본, numpy는 dtype float64 기본

# CPU GPU 인스턴스 다름


```python
x1 = torch.linspace(0,1,10)
print(x1.dtype,x1.device,x1[:5])
x2 = torch.linspace(0,1,10).to('cuda' if torch.cuda.is_available() else 'cpu')
print(x2.dtype,x2.device,x2[:5])
print(x1-x1)
print(x2-x2)
print(x1-x2)
```


```python
torch.float32 cpu tensor([0.0000, 0.1111, 0.2222, 0.3333, 0.4444])
torch.float32 cuda:0 tensor([0.0000, 0.1111, 0.2222, 0.3333, 0.4444], device='cuda:0')
tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], device='cuda:0')
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
Cell In[24], line 7
      5 print(x1-x1)
      6 print(x2-x2)
----> 7 print(x1-x2)

RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
```

연산은 동일 장치에서 수행되어야 함. 그래서 변환해야 함. 메모리 복사 일어날듯

```python
print(x1.to(x2.device)-x2)
print(x1-x2.to(x1.device))
```

pytorch.tensor > numpy 변환시에도 cpu로 값을 넘겨줘야함